
# Postgres / Cloud SQL: publications_schema
(Операционное хранилище / Operational Store)

## Что это такое (по-человечески)
Postgres в этой архитектуре — это **машинная версия мира**: здесь лежат документы в структурированном виде, связи, таксоны, а также embeddings.  
Он нужен, чтобы быстро отвечать на вопросы: “найди”, “отфильтруй”, “покажи связи”, “дай контекст агенту”.

## Что важно не забыть (чек-лист мыслей)

### 1) Что БД обязана хранить
- Документы (documents): id, type, title, content, status, date_ym и т.д.
- Таксоны (taxons): rubrics / categories / keywords / subrubrics
- Связи документов с таксонами (join): document_taxons
- Связи документов между собой: document_links
- Внешние ссылки: external_links
- Embeddings:
  - embeddings_documents
  - embeddings_chunks

### 2) Что реально защищает от “сломали SQL базу”
- **Транзакции (transactions)**  
  Либо весь пакет изменений записался целиком, либо ничего.
- **Staging → Promote (черновик → публикация)**  
  Сначала запись/проверка в staging, потом переключение на “боевую” версию.
- **Версионирование/бэкапы**  
  Если записали что-то не так — можно откатить.

### 3) Практический смысл защиты
- Можно экспериментировать с pipeline, не боясь разрушить рабочие данные.
- Ошибки в логике не становятся катастрофой.
- Провайдер (DO/GCP) не “исправляет данные”; защиту обеспечивает архитектура.
